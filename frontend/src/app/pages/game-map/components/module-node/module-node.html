<!-- frontend/src/app/pages/game-map/components/module-node/module-node.html -->

<div class="module-card">
  <!-- Header del MÃ³dulo -->
  <div class="module-header">
    <div class="module-info">
      <h2 class="module-title">ğŸ“¦ {{ module.title }}</h2>
      <p class="module-description">{{ module.description }}</p>
      <div class="module-meta">
        <span class="meta-item">ğŸ“š {{ module.lessons.length }} lecciones</span>
        <span class="meta-item">â±ï¸ ~{{ module.estimate_time }} min</span>
      </div>
    </div>

    <!-- Controles de Profesor -->
    @if (isTeacher) {
      <div class="module-controls">
        <button 
          class="btn-icon btn-edit"
          (click)="editModule.emit()"
          title="Editar mÃ³dulo">
          âœï¸
        </button>
        <button 
          class="btn-icon btn-delete"
          (click)="deleteModule.emit()"
          title="Eliminar mÃ³dulo">
          ğŸ—‘ï¸
        </button>
      </div>
    }
  </div>

  <!-- Mapa de Lecciones -->
  <div class="lessons-map">
    @for (lesson of module.lessons; track lesson._id; let i = $index) {
      <app-lesson-node
        [lesson]="lesson"
        [lessonIndex]="i"
        [isTeacher]="isTeacher"
        (click)="onLessonClick(lesson._id, i)">
      </app-lesson-node>
      
      <!-- LÃ­nea conectora (excepto despuÃ©s de la Ãºltima) -->
      @if (i < module.lessons.length - 1) {
        <div class="lesson-connector"></div>
      }
    }

    <!-- BotÃ³n Agregar LecciÃ³n (Solo Profesor) -->
    @if (isTeacher) {
      <button 
        class="btn-add-lesson"
        (click)="addLesson.emit()"
        title="Agregar nueva lecciÃ³n">
        â•
      </button>
    }
  </div>
</div>
